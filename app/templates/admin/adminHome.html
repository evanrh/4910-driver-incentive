{% extends "admin/adminBase.html" %}
{% block header %}
<style>
    .sponsor-chart {
        height: 500px;
        width: 700px;
    }
</style>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
  google.charts.load('current', {'packages':['corechart']});
  google.charts.setOnLoadCallback(drawChart);

  function drawChart() {
    var data = google.visualization.arrayToDataTable([
      ['Year', 'Sales', 'Expenses'],
      ['2004',  1000,      400],
      ['2005',  1170,      460],
      ['2006',  660,       1120],
      ['2007',  1030,      540]
    ]);

    var options = {
      title: 'Company Performance',
      curveType: 'function',
      legend: { position: 'bottom' }
    };

var chart = new google.visualization.LineChart(document.getElementById('curve_chart'));
    chart.draw(data, options);
    var chart = new google.visualization.LineChart(document.getElementById('curve_chart2'));
    chart.draw(data, options);
    var chart = new google.visualization.LineChart(document.getElementById('curve_chart3'));
    chart.draw(data, options);
    var chart = new google.visualization.LineChart(document.getElementById('curve_chart4'));
    chart.draw(data, options);
    var chart = new google.visualization.LineChart(document.getElementById('curve_chart5'));
    chart.draw(data, options);
    var chart = new google.visualization.LineChart(document.getElementById('curve_chart6'));
    chart.draw(data, options);
    
  }
</script>
{% endblock %}


{% block adminContent %}
<div class = "header-banner">{{ head }} </div>
<h1>Application Statistics</h1>
<div id="charts">
<div class="row">
    <div class="one-half">
        <h2>Sponsor 1</h2>
        <div id="curve_chart" style="width: 700px; height: 500px"></div>
    </div>
    <div class="one-half">
        <h2>Sponsor 2</h2>
        <div id="curve_chart2" style="width: 700px; height: 500px"></div>
    </div>
</div>
<div class="row">
    <div class="one-half">
        <h2>Sponsor 3</h2>
        <div id="curve_chart3" style="width: 700px; height: 500px"></div>
    </div>
    <div class="one-half">
        <h2>Sponsor 4</h2>
        <div id="curve_chart4" style="width: 700px; height: 500px"></div>
    </div>
</div>
<div class="row">
    <div class="one-half">
        <h2>Sponsor 5</h2>
        <div id="curve_chart5" style="width: 700px; height: 500px"></div>
    </div>
    <div class="one-half">
        <h2>Sponsor 6</h2>
        <div id="curve_chart6" style="width: 700px; height: 500px"></div>
    </div>
</div>
</div>
{% endblock %}
{% block footer %}
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<script type="text/javascript">
google.charts.load('visualization', { packages: ['corechart'] });
google.charts.setOnLoadCallback(drawLineChart);
function drawLineChart() {
    var loc = "{{ url_for('sponList') }}";
    var months = Array.from(Array(13).keys()).slice(1)
    $.ajax({
        contentType: 'application/json; charset=utf-8',
        dataType: 'json',
        url: loc,
        type: 'POST',
        data: '',
        success: function(response) {
            $.each(response, (index, value) => {
                var node = document.createElement('div');
                node.className = 'sponsor-chart';
                document.getElementById('charts').appendChild(node);
                
                var trace = {
                    x: months,
                    y: Object.keys(value['results']).map((key, index) => value['results'][key]),
                    type: 'scatter'
                };
                var layout = {
                    title: value['info'][0] + "'s Sales",
                    xaxis: { title: 'Month' },
                    yaxis: { title: 'Sales' }
                };
                var fig = {
                    data: [trace],
                    layout: layout
                };

                Plotly.newPlot(node, fig);
            });
        }
    });
}
    
</script>
{% endblock %}
